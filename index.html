<!DOCTYPE html>
<html>
<head>
  <title>Expiry Dairy</title>
  <style>
    .autocomplete {
      position: relative;
      display: inline-block;
    }

    input[type="text"] {
      width: 300px;
      padding: 10px;
      font-size: 16px;
    }

    .autocomplete-items {
      position: absolute;
      border: 1px solid #d4d4d4;
      border-top: none;
      z-index: 99;
      top: 100%;
      left: 0;
      right: 0;
    }

    .autocomplete-item {
      padding: 10px;
      cursor: pointer;
      background-color: #fff;
    }

    .autocomplete-item:hover {
      background-color: #e9e9e9;
    }

    .selected-item {
      margin-top: 20px;
      font-size: 24px;
    }

    .selected-item-name {
      font-weight: bold;
    }

    .selected-item-expiry {
      margin-top: 10px;
      color: gray;
    }

    .add-item-popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #fff;
      padding: 20px;
      border: 1px solid #d4d4d4;
      z-index: 100;
    }

    .expiry-list {
      margin-top: 20px;
    }

    .expiry-item {
      display: flex;
      align-items: center;
      margin-bottom: 10px;
      padding: 10px;
      border-radius: 5px;
    }

    .expiry-item-name {
      font-weight: bold;
      margin-right: 10px;
    }

    .expiry-item-expiry {
      color: gray;
    }
  </style>
</head>
<body>
  <h2>Expiry Dairy</h2>
  <p> Search and add your expires to this dairy </p>
  <div class="autocomplete">
    <input type="text" id="searchInput" placeholder="Search...">
    <div class="autocomplete-items" id="autocompleteItems"></div>
  </div>
  <button id="searchButton">Search</button>
  <button id="addItemButton">Add Item</button>

  <div class="add-item-popup" id="addItemPopup">
    <input type="text" id="newItemNameInput" placeholder="Item Name">
    <input type="date" id="newItemExpiryInput" placeholder="Expiry Date">
    <button id="saveItemButton">Save</button>
    <button id="cancelItemButton">Cancel</button>
  </div>

  <div id="selectedItemContainer" class="selected-item" style="display: none;">
    <div id="selectedItemName" class="selected-item-name"></div>
    <div id="selectedItemExpiry" class="selected-item-expiry"></div>
  </div>

  <div class="expiry-list" id="expiryList"></div>

  <script>
    const searchInput = document.getElementById('searchInput');
    const autocompleteItems = document.getElementById('autocompleteItems');
    const searchButton = document.getElementById('searchButton');
    const addItemButton = document.getElementById('addItemButton');
    const addItemPopup = document.getElementById('addItemPopup');
    const newItemNameInput = document.getElementById('newItemNameInput');
    const newItemExpiryInput = document.getElementById('newItemExpiryInput');
    const saveItemButton = document.getElementById('saveItemButton');
    const cancelItemButton = document.getElementById('cancelItemButton');
    const selectedItemContainer = document.getElementById('selectedItemContainer');
    const selectedItemName = document.getElementById('selectedItemName');
    const selectedItemExpiry = document.getElementById('selectedItemExpiry');
    const expiryList = document.getElementById('expiryList');

    const suggestionList = [
      { name: 'Apple', expiry: '2023-06-30' },
      { name: 'Banana', expiry: '2023-07-02' },
      { name: 'Cherry', expiry: '2023-07-05' },
      { name: 'Grape', expiry: '2023-07-01' },
      { name: 'Lemon', expiry: '2023-06-28' },
      { name: 'Orange', expiry: '2023-07-03' },
      { name: 'Peach', expiry: '2023-06-29' },
      { name: 'Pear', expiry: '2023-07-04' },
      { name: 'Strawberry', expiry: '2023-07-06' },
      { name: 'Watermelon', expiry: '2023-07-07' }
    ];

    searchInput.addEventListener('input', function() {
      const searchText = this.value.trim();

      // Clear previous results
      autocompleteItems.innerHTML = '';

      if (searchText.length > 0) {
        // Filter autocomplete suggestions based on input
        const filteredSuggestions = getSuggestionsFromServer(searchText);

        filteredSuggestions.forEach(function(suggestion) {
          const item = document.createElement('div');
          item.classList.add('autocomplete-item');
          item.textContent = suggestion.name;
          item.addEventListener('click', function() {
            // Set the selected suggestion as the search input value
            searchInput.value = suggestion.name;
            autocompleteItems.innerHTML = '';

            // Display the selected item with name and expiry
            selectedItemName.textContent = suggestion.name;
            selectedItemExpiry.textContent = 'Expiry: ' + suggestion.expiry;
            selectedItemContainer.style.display = 'block';
          });
          autocompleteItems.appendChild(item);
        });
      }
    });

    searchButton.addEventListener('click', function() {
      const searchText = searchInput.value.trim();
      if (searchText.length > 0) {
        console.log('Search triggered with:', searchText);
        // Call your search function or perform any desired action here
      }
    });

    addItemButton.addEventListener('click', function() {
      addItemPopup.style.display = 'block';
    });

    cancelItemButton.addEventListener('click', function() {
      addItemPopup.style.display = 'none';
    });

    saveItemButton.addEventListener('click', function() {
      const newItemName = newItemNameInput.value.trim();
      const newItemExpiry = newItemExpiryInput.value;
      if (newItemName.length > 0 && newItemExpiry) {
        suggestionList.push({ name: newItemName, expiry: newItemExpiry });

        addItemPopup.style.display = 'none';
        newItemNameInput.value = '';
        newItemExpiryInput.value = '';
      }
    });

    function getSuggestionsFromServer(searchText) {
      return suggestionList.filter(function(suggestion) {
        return suggestion.name.toLowerCase().startsWith(searchText.toLowerCase());
      });
    }

    function getExpiryItems() {
      const currentDate = new Date();
      const sortedExpiryList = suggestionList
        .filter(function(suggestion) {
          const expiryDate = new Date(suggestion.expiry);
          return expiryDate > currentDate;
        })
        .sort(function(a, b) {
          const expiryDateA = new Date(a.expiry);
          const expiryDateB = new Date(b.expiry);
          return expiryDateA - expiryDateB;
        })
        .slice(0, 10);

      expiryList.innerHTML = '';

      sortedExpiryList.forEach(function(item) {
        const expiryItem = document.createElement('div');
        expiryItem.classList.add('expiry-item');

        const expiryItemName = document.createElement('div');
        expiryItemName.classList.add('expiry-item-name');
        expiryItemName.textContent = item.name;

        const expiryItemExpiry = document.createElement('div');
        expiryItemExpiry.classList.add('expiry-item-expiry');
        expiryItemExpiry.textContent = 'Expiry: ' + item.expiry;

        expiryItem.appendChild(expiryItemName);
        expiryItem.appendChild(expiryItemExpiry);

        expiryList.appendChild(expiryItem);
      });
    }

    getExpiryItems();
  </script>
</body>
</html>
